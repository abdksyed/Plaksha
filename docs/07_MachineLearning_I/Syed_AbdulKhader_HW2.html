<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Abdul Khader, Syed">
<meta name="description" content="Linear Regression and Support Vector Machines">

<title>Plaksha - Machine Learning Homework II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Plaksha</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Machine Learning Homework II</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_Mathematics_I/index.html" class="sidebar-item-text sidebar-link">Mathematics I</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_Python_Programming/index.html" class="sidebar-item-text sidebar-link">Introduction to Prgramming</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Intro_AI/index.html" class="sidebar-item-text sidebar-link">Introduction to Artificial Intelligence</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_DataVisualization/index.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_Mathematics_II/index.html" class="sidebar-item-text sidebar-link">Mathematics II</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-1" id="toc-problem-1" class="nav-link active" data-scroll-target="#problem-1">Problem 1</a></li>
  <li><a href="#problem-2" id="toc-problem-2" class="nav-link" data-scroll-target="#problem-2">Problem 2</a></li>
  <li><a href="#problem-3" id="toc-problem-3" class="nav-link" data-scroll-target="#problem-3">Problem 3</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Machine Learning Homework II</h1>
</div>

<div>
  <div class="description">
    Linear Regression and Support Vector Machines
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Abdul Khader, Syed </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
<p>In real world applications, there are outliers in data. This can be dealt with using a soft margin, specified in a slightly different optimization problem as below (soft-margin SVM):</p>
<p><span class="math display">\[
min \frac{1}{2}w^Tw + C \sum_{i}^{N} \xi_i where \xi_i \ge 0
\\
s.t. y^{(i)} (w^Tx^{(i)} + b) \ge 1 - \xi_i
\]</span></p>
<p><span class="math inline">\(ξi\)</span> represents the slack for each data point <span class="math inline">\(i\)</span>, which allows misclassification of datapoints in the event that the data is not linearly seperable. SVM without the addition of slack terms is known as hard-margin SVM.</p>
<p><img src="./data/SVM.jpg" style="height:70.0%"></p>
<section id="intuitively-where-do-the-data-points-lie-relative-to-where-the-margin-is-when-ξi-0-are-all-training-data-points-classified-correctly" class="level4">
<h4 class="anchored" data-anchor-id="intuitively-where-do-the-data-points-lie-relative-to-where-the-margin-is-when-ξi-0-are-all-training-data-points-classified-correctly">1. Intuitively, where do the data points lie relative to where the margin is when <span class="math inline">\(ξi\)</span> = 0 ? Are all training data points classified correctly?</h4>
<p>We know that, <span class="math inline">\(ξi\)</span> is the distance between the support vector plane (margins) and the incorrectly classified data point. For example, for a data point which belongs to a positive class, <span class="math inline">\(ξi\)</span> is the distance between the datapoint and <span class="math inline">\(\pi^+\)</span> margin. If the data point is above the <span class="math inline">\(\pi^+\)</span> margin, than <span class="math inline">\(ξi = 0\)</span>, since the point was correctly classified.</p>
<p>Similarly for a data point belonging to negative class, <span class="math inline">\(ξi\)</span> is the distance between that point and <span class="math inline">\(\pi^-\)</span> margin, if the data point is below the <span class="math inline">\(\pi^-\)</span> margin, than <span class="math inline">\(ξi = 0\)</span>, since the point was correctly classified.</p>
<p>The <strong>Data Points lie on or above(for positive class)/below(for negative class) the margin (support vectors) when <span class="math inline">\(ξi = 0\)</span></strong> In the above diagram <span class="math inline">\(x_k\)</span> is such a point and <span class="math inline">\(x_i\)</span>.</p>
<section id="are-all-training-data-points-classified-correctly" class="level5">
<h5 class="anchored" data-anchor-id="are-all-training-data-points-classified-correctly">Are all training data points classified correctly?</h5>
<p><strong>Yes</strong>, all the training data points whose <span class="math inline">\(ξi=0\)</span> are correctly classified.</p>
</section>
</section>
<section id="intuitively-where-does-each-data-point-lie-relative-to-where-the-margin-is-when-0-ξi-1-are-all-training-data-point-classified-correctly" class="level4">
<h4 class="anchored" data-anchor-id="intuitively-where-does-each-data-point-lie-relative-to-where-the-margin-is-when-0-ξi-1-are-all-training-data-point-classified-correctly">2.Intuitively, where does each data point lie relative to where the margin is when <span class="math inline">\(0 &lt; ξi ≤ 1\)</span> ? Are all training data point classified correctly?</h4>
<p>As mentioned above, <span class="math inline">\(ξi\)</span> is the distance from the margin (support vector) to the data point, which is <span class="math inline">\(1-Z_i\)</span> for incorrectly classified points and 0 otherwise. When <span class="math inline">\(0 &lt; ξi \le 1\)</span>, the point lies between the margin and hyperplane. Also given <span class="math inline">\(ξi=1\)</span>, so the data point can lie on the hyperplane too, when the distance between the margin and data point is 1, which is distance between the margin and hyperplane.</p>
<section id="are-all-training-data-points-classified-correctly-1" class="level5">
<h5 class="anchored" data-anchor-id="are-all-training-data-points-classified-correctly-1">Are all training data points classified correctly?</h5>
<p>And, <strong>No</strong>, All the training points are incorrectly classified while <strong>training</strong>. During testing we just check where does the point lie realtive to the hyperplane <span class="math inline">\(f(x) = w^Tx + b\)</span>. If <span class="math inline">\(f(x) &gt; 0\)</span> we say positive class, and if <span class="math inline">\(f(x) &lt; 0\)</span> we say negative class.</p>
<p>But while training we want the data point of the class to be above the positive margin <span class="math inline">\(\pi^+\)</span> (<span class="math inline">\(w^Tx + b \ge 1\)</span>) for positive class and below the negative margin <span class="math inline">\(\pi^-\)</span>(<span class="math inline">\(w^Tx + b \le 1\)</span>) for negative class. The soft margin assumes this data points between the margins to be incorrectly classified and add them to the error term during the optimization.</p>
</section>
</section>
<section id="intuitively-where-does-each-data-point-lie-relative-to-where-the-margin-is-when-ξi-1-are-all-training-data-points-classified-correctly" class="level4">
<h4 class="anchored" data-anchor-id="intuitively-where-does-each-data-point-lie-relative-to-where-the-margin-is-when-ξi-1-are-all-training-data-points-classified-correctly">3. Intuitively, where does each data point lie relative to where the margin is when <span class="math inline">\(ξi &gt; 1\)</span> ? Are all training data points classified correctly?</h4>
<p>When <span class="math inline">\(ξi &gt; 1\)</span>, the data points are in the opposite direction of the hyperplane and are more than 1 distance away from the margin. The point is clearly misclassified.</p>
<p>For positive points, the point will lie below the hyperplane which is more than 1 distance below from <span class="math inline">\(\pi^+\)</span> and for negative points, the point will lie above the hyperplane and more than 1 distance above the <span class="math inline">\(\pi^-\)</span>.</p>
<section id="are-all-training-data-points-classified-correctly-2" class="level5">
<h5 class="anchored" data-anchor-id="are-all-training-data-points-classified-correctly-2">Are all training data points classified correctly?</h5>
<p><strong>No</strong>, All the training points whose <span class="math inline">\(ξi&gt;1\)</span> are incorrectly classified.</p>
</section>
</section>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
<p>Support Vector Machines can be used to perform non-linear classification with a kernel trick. Recall the hard-margin SVM from class:</p>
<p><span class="math display">\[
min \frac{1}{2}w^Tw
\\
s.t. y^{(i)} (w^Tx^{(i)} + b) \ge 1
\]</span></p>
<p>The dual of this primal problem can be specified as a procedure to learn the following linear classifier: <span class="math display">\[
f(x) = \sum_{i}^{N} \alpha_i y_i (x_i^Tx) + b
\]</span> Note that now we can replace <span class="math inline">\(x_i^Tx\)</span> with a kernel <span class="math inline">\(k(x_i,x)\)</span>, and have a non-linear decision boundary.</p>
<p>In Figure, there are different SVMs with different shapes/patterns of decision boundaries. The training data is labeled as <span class="math inline">\(y_i ∈ \{−1, 1\}\)</span>, represented as the shape of circles and squares respectively. Support vectors are drawn in solid circles/squares. Match the scenarios described below to one of the 6 plots (note that one of the plots does not match to anything). Each scenario should be matched to a unique plot. Explain in less than two sentences why it is the case for each scenario.</p>
<section id="a-soft-margin-linear-svm-with-c-0.02." class="level4">
<h4 class="anchored" data-anchor-id="a-soft-margin-linear-svm-with-c-0.02.">1. A soft-margin linear SVM with C = 0.02.</h4>
<p>Linear Soft margin, with a very low value of C indicated that the model can have higher values of <span class="math inline">\(\xi\)</span>, and model is fine with some misclassification but desires higher variance, which is depicted by <strong>Figure 4</strong>.</p>
<p><img src="./data/4.png" class="img-fluid" style="width:30.0%"></p>
</section>
<section id="a-soft-margin-linear-svm-with-c-20." class="level4">
<h4 class="anchored" data-anchor-id="a-soft-margin-linear-svm-with-c-20.">2. A soft-margin linear SVM with C = 20.</h4>
<p>Linear Soft margin, with a high value of C indicated that we want lower values of <span class="math inline">\(\xi\)</span>, and we are not so hard with misclassification and desired higher bias and closer parallel linear margins, which is depicted by <strong>Figure 3</strong>.</p>
<p><img src="./data/3.png" style="height:30.0%"></p>
</section>
<section id="a-hard-margin-kernel-svm-with-ku-v-u-v-u-v2" class="level4">
<h4 class="anchored" data-anchor-id="a-hard-margin-kernel-svm-with-ku-v-u-v-u-v2">3. A hard-margin kernel SVM with <span class="math inline">\(k(u, v) = u · v + (u · v)^2\)</span></h4>
<p>Here the hard margin kernel SVM has a kernel which have the function which is hyperbollic, and <strong>Figure 5</strong> has a hyperbolla margins.</p>
<p><img src="./data/5.png" style="height:30.0%"></p>
</section>
<section id="a-hard-margin-kernel-svm-with-ku-v-exp5u-v2" class="level4">
<h4 class="anchored" data-anchor-id="a-hard-margin-kernel-svm-with-ku-v-exp5u-v2">4. A hard-margin kernel SVM with <span class="math inline">\(k(u, v) = exp(−5||u − v||^2)\)</span></h4>
<p>With the high value of <span class="math inline">\(\gamma\)</span> in RBF kernel <span class="math inline">\(exp(-\gamma|||u − v||^2)\)</span>, the kernel value is small and needs more support vectors for classifiaction which is as depiced in <strong>Figure 6</strong></p>
<p><img src="./data/6.png" style="height:30.0%"></p>
</section>
<section id="a-hard-margin-kernel-svm-with-ku-v-expfrac15u-v2" class="level4">
<h4 class="anchored" data-anchor-id="a-hard-margin-kernel-svm-with-ku-v-expfrac15u-v2">5. A hard-margin kernel SVM with <span class="math inline">\(k(u, v) = exp(−\frac{1}{5}||u − v||^2)\)</span></h4>
<p>With the lower value of <span class="math inline">\(\gamma\)</span> in RBF kernel <span class="math inline">\(exp(-\gamma|||u − v||^2)\)</span>, the kernel value is higher and we can classify data points using fewer support vectors, which is depiced in <strong>Figure 1</strong></p>
<p><img src="./data/1.png" style="height:30.0%"></p>
</section>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
<p>Suppose we have the following data on seven variables <span class="math inline">\(x1, · · · , x7\)</span> and the output <span class="math inline">\(y\)</span>, given as fol- lows:</p>
<div class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([[<span class="fl">0.94</span>,<span class="fl">0.37</span>, <span class="fl">0.76</span>, <span class="fl">0.56</span>, <span class="fl">0.77</span> ,<span class="fl">0.51</span> ,<span class="fl">0.80</span>],</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>[<span class="op">-</span><span class="fl">0.88</span> ,<span class="op">-</span><span class="fl">0.33</span>,<span class="op">-</span><span class="fl">0.68</span>,<span class="op">-</span><span class="fl">0.51</span> ,<span class="op">-</span><span class="fl">0.75</span> ,<span class="op">-</span><span class="fl">0.47</span>, <span class="op">-</span><span class="fl">0.76</span>],</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1.32</span> ,<span class="op">-</span><span class="fl">0.31</span> ,<span class="fl">0.78</span> ,<span class="fl">0.23</span>, <span class="fl">0.47</span> ,<span class="fl">0.10</span> ,<span class="fl">0.90</span>],</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>[<span class="op">-</span><span class="fl">0.21</span> ,<span class="fl">0.79</span>, <span class="fl">0.13</span>, <span class="fl">0.46</span>,<span class="fl">0.27</span> ,<span class="fl">0.54</span>, <span class="fl">0.05</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>[ <span class="fl">0.75</span> ,<span class="op">-</span><span class="fl">0.70</span> ,<span class="fl">0.28</span> ,<span class="op">-</span><span class="fl">0.22</span>, <span class="op">-</span><span class="fl">0.07</span> ,<span class="op">-</span><span class="fl">0.34</span> ,<span class="fl">0.39</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>[ <span class="op">-</span><span class="fl">0.33</span>, <span class="op">-</span><span class="fl">1.30</span> ,<span class="op">-</span><span class="fl">0.66</span>, <span class="op">-</span><span class="fl">0.98</span>, <span class="op">-</span><span class="fl">0.86</span> ,<span class="op">-</span><span class="fl">1.06</span>, <span class="op">-</span><span class="fl">0.57</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1.27</span> ,<span class="fl">0.81</span> ,<span class="fl">1.14</span>, <span class="fl">0.96</span> ,<span class="fl">1.08</span>, <span class="fl">0.92</span>, <span class="fl">1.15</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>[ <span class="op">-</span><span class="fl">0.60</span>, <span class="fl">0.84</span>, <span class="op">-</span><span class="fl">0.13</span>, <span class="fl">0.36</span>, <span class="fl">0.35</span>, <span class="fl">0.48</span>, <span class="op">-</span><span class="fl">0.24</span>],</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>[ <span class="fl">0.15</span>,<span class="op">-</span><span class="fl">1.35</span> ,<span class="op">-</span><span class="fl">0.35</span> ,<span class="op">-</span><span class="fl">0.85</span> ,<span class="op">-</span><span class="fl">0.47</span> ,<span class="op">-</span><span class="fl">0.98</span> ,<span class="op">-</span><span class="fl">0.22</span>],</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>[<span class="op">-</span><span class="fl">0.33</span>, <span class="fl">0.86</span>, <span class="fl">0.07</span>, <span class="fl">0.46</span> ,<span class="fl">0.37</span>, <span class="fl">0.56</span>, <span class="op">-</span><span class="fl">0.03</span>]])</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="fl">0.66</span>, <span class="op">-</span><span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.29</span>, <span class="fl">0.03</span>, <span class="op">-</span><span class="fl">0.82</span>, <span class="fl">1.04</span>, <span class="fl">0.12</span>, <span class="op">-</span><span class="fl">0.60</span>, <span class="fl">0.26</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="find-the-linear-regression-to-this-data-using-the-closed-form-expressions-can-use-calculators.-does-the-formula-work-if-not-explain-why-not." class="level4">
<h4 class="anchored" data-anchor-id="find-the-linear-regression-to-this-data-using-the-closed-form-expressions-can-use-calculators.-does-the-formula-work-if-not-explain-why-not.">1. Find the linear regression to this data using the closed form expressions (can use calculators). Does the formula work? If not, explain why not.</h4>
<div class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>xTx <span class="op">=</span> np.matmul(x.T, x)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>np.linalg.det(xTx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>3.1679045781163164e-16</code></pre>
</div>
</div>
<p>The determinant of <span class="math inline">\(X^Tx\)</span> is very small. If this is approximated than the determinant will go to zero, and the inverse won’t exist. Since the inverse won’t exist, the problem can not be solved in closed form.</p>
<p>But if we go ahead with the small value of determinant and find the inverse, and continue to find the weights using the closed form where the weights <span class="math inline">\(\beta = (x^Tx)^{-1} x^T y\)</span>. We get the weights of the model.</p>
<div class="cell" data-execution_count="226">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>xTx_inv <span class="op">=</span> np.linalg.inv(xTx)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> np.matmul(np.matmul(xTx_inv, x.T), y)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> np.matmul(x, weights)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>rss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="226">
<pre><code>6.496738215544207e-05</code></pre>
</div>
</div>
<div class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x1,x2,x3,x4,x5,x6,x7 <span class="op">=</span> np.<span class="bu">round</span>(weights, <span class="dv">3</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>display(Latex(<span class="ss">f'$f(x) = (</span><span class="sc">{</span>x1<span class="sc">}</span><span class="ss">)*x_1 +  (</span><span class="sc">{</span>x2<span class="sc">}</span><span class="ss">)*x_2 +   (</span><span class="sc">{</span>x3<span class="sc">}</span><span class="ss">)*x_3 +   (</span><span class="sc">{</span>x4<span class="sc">}</span><span class="ss">)*x_4 + (</span><span class="sc">{</span>x5<span class="sc">}</span><span class="ss">)*x_5 + </span><span class="ch">\</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ss">                (</span><span class="sc">{</span>x6<span class="sc">}</span><span class="ss">)*x_6 + (</span><span class="sc">{</span>x7<span class="sc">}</span><span class="ss">)*x_7$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><span class="math inline">\(f(x) = (-0.395)*x_1 + (-0.865)*x_2 + (0.501)*x_3 + (0.623)*x_4 + (0.021)*x_5 + (0.982)*x_6 + (0.128)*x_7\)</span></p>
</div>
</div>
</section>
<section id="fit-a-linear-ridge-regression-model-to-this-data-using-the-closed-form-expressions" class="level4">
<h4 class="anchored" data-anchor-id="fit-a-linear-ridge-regression-model-to-this-data-using-the-closed-form-expressions">2. Fit a linear ridge regression model to this data using the closed form expressions</h4>
<div class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>LAMBDA <span class="op">=</span> <span class="fl">10e-4</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>xTx_inv <span class="op">=</span> np.linalg.inv(xTx <span class="op">+</span> LAMBDA<span class="op">*</span>np.eye(<span class="dv">7</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> np.matmul(np.matmul(xTx_inv, x.T), y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> np.matmul(x, weights)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="244">
<pre><code>9.375815496416118e-05</code></pre>
</div>
</div>
<div class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x1,x2,x3,x4,x5,x6,x7 <span class="op">=</span> np.<span class="bu">round</span>(weights, <span class="dv">3</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>display(Latex(<span class="ss">f'$f(x) = (</span><span class="sc">{</span>x1<span class="sc">}</span><span class="ss">)*x_1 +  (</span><span class="sc">{</span>x2<span class="sc">}</span><span class="ss">)*x_2 +   (</span><span class="sc">{</span>x3<span class="sc">}</span><span class="ss">)*x_3 +   (</span><span class="sc">{</span>x4<span class="sc">}</span><span class="ss">)*x_4 + (</span><span class="sc">{</span>x5<span class="sc">}</span><span class="ss">)*x_5 + </span><span class="ch">\</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ss">                (</span><span class="sc">{</span>x6<span class="sc">}</span><span class="ss">)*x_6 + (</span><span class="sc">{</span>x7<span class="sc">}</span><span class="ss">)*x_7$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><span class="math inline">\(f(x) = (-0.374)*x_1 + (-0.831)*x_2 + (0.487)*x_3 + (0.634)*x_4 + (0.021)*x_5 + (0.936)*x_6 + (0.124)*x_7\)</span></p>
</div>
</div>
</section>
<section id="fit-a-linear-lasso-regression-model-to-this-data-using-a-computer-program---can-use-packages." class="level4">
<h4 class="anchored" data-anchor-id="fit-a-linear-lasso-regression-model-to-this-data-using-a-computer-program---can-use-packages.">3. Fit a linear lasso regression model to this data using a computer program - can use packages.</h4>
<div class="cell" data-execution_count="238">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lasso_reg <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">10e-4</span>, fit_intercept<span class="op">=</span><span class="va">False</span>).fit(x, y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> lasso_reg.predict(x)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>rss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="238">
<pre><code>0.00015660574547596038</code></pre>
</div>
</div>
<div class="cell" data-execution_count="239">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x1,x2,x3,x4,x5,x6,x7 <span class="op">=</span> np.<span class="bu">round</span>(lasso_reg.coef_, <span class="dv">3</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>display(Latex(<span class="ss">f'$f(x) = (</span><span class="sc">{</span>x1<span class="sc">}</span><span class="ss">)*x_1 +  (</span><span class="sc">{</span>x2<span class="sc">}</span><span class="ss">)*x_2 +   (</span><span class="sc">{</span>x3<span class="sc">}</span><span class="ss">)*x_3 +   (</span><span class="sc">{</span>x4<span class="sc">}</span><span class="ss">)*x_4 + (</span><span class="sc">{</span>x5<span class="sc">}</span><span class="ss">)*x_5 + </span><span class="ch">\</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="ss">                (</span><span class="sc">{</span>x6<span class="sc">}</span><span class="ss">)*x_6 + (</span><span class="sc">{</span>x7<span class="sc">}</span><span class="ss">)*x_7$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><span class="math inline">\(f(x) = (0.452)*x_1 + (0.475)*x_2 + (0.069)*x_3 + (0.0)*x_4 + (0.0)*x_5 + (0.0)*x_6 + (0.0)*x_7\)</span></p>
</div>
</div>
</section>
<section id="use-the-following-subset-selection-methods-to-choose-the-two-features-that-best-explain-the-data" class="level4">
<h4 class="anchored" data-anchor-id="use-the-following-subset-selection-methods-to-choose-the-two-features-that-best-explain-the-data">4. Use the following subset selection methods to choose the two features that best explain the data:</h4>
<section id="a.-forward-stepwise" class="level5">
<h5 class="anchored" data-anchor-id="a.-forward-stepwise">a. Forward Stepwise</h5>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"feature, RSS Value, Weight"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">7</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> x[:,i].copy()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> temp_x.T</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    xTx <span class="op">=</span> np.matmul(temp_x.T, temp_x)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    xTx_inv <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>xTx</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> xTx_inv<span class="op">*</span>np.matmul(temp_x.T,y)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> weight<span class="op">*</span>temp_x</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>), weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>feature, RSS Value, Weight
0 1.7680480306099482 0.5005626828719334
1 1.5559485515856177 0.5004526294944694
2 0.34805009659969083 0.9066846986089646
3 0.3239590689664171 0.885160347571954
4 0.10393465264034997 0.9160504114154776
5 0.6325514156337191 0.7849334492064217
6 0.6943223421821415 0.8177314873618696</code></pre>
</div>
</div>
<p>As we can see the feature 5 has the least RSS, so we select feature 5 as the first feature and can go for further selection.</p>
<div class="cell" data-execution_count="207">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x_5 <span class="op">=</span> x[:,<span class="dv">4</span>].copy()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"feature, RSS Value, Weight Vector"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">7</span>):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> x[:,i].copy()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> np.array([x_5,temp_x])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> temp_x.T</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    xTx <span class="op">=</span> np.matmul(temp_x.T, temp_x)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    xTx_inv <span class="op">=</span> np.linalg.inv(xTx)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> np.matmul(np.matmul(xTx_inv, temp_x.T), y)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> np.matmul(temp_x, weights)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>), weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>feature, RSS Value, Weight Vector
0 0.08939491221949343 [0.86424766 0.06320073]
1 0.10375136110003312 [ 0.92379547 -0.00764925]
2 0.06418266693959254 [0.68199387 0.26275088]
3 0.09441954725164416 [0.76785156 0.15649981]
5 0.10191595411157069 [0.86769165 0.05015582]
6 0.07826337555928795 [0.77953228 0.15717367]</code></pre>
</div>
</div>
<p>Here, the <strong>feature 3</strong> in combination with <strong>feature 5</strong> since it has the least RSS value. Also we see that the weight value related to feature 5 has changed from 0.916 to 0.767</p>
</section>
<section id="b.-backward-stepwise" class="level5">
<h5 class="anchored" data-anchor-id="b.-backward-stepwise">b. Backward Stepwise</h5>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_rss(x):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    xTx <span class="op">=</span> np.matmul(x.T, x)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    xTx_inv <span class="op">=</span> np.linalg.inv(xTx)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> np.matmul(np.matmul(xTx_inv, x.T), y)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> np.matmul(x, weights)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    rss <span class="op">=</span> np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> i <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    comb <span class="op">=</span> <span class="bu">list</span>(itertools.combinations(features, i))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    rss <span class="op">=</span> []</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> comb:</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        temp_x <span class="op">=</span> x.copy()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        temp_x <span class="op">=</span> temp_x.T</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        temp_x <span class="op">=</span> temp_x[<span class="bu">list</span>(j)].T</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        rss.append(get_rss(temp_x))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    rss <span class="op">=</span> np.array(rss)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> <span class="bu">list</span>(comb[rss.argmin()])</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Features Index"</span>,features)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.775622303276243e-05
6.85232574647189e-05
7.037563225111191e-05
7.54452176001615e-05
0.000110076377459281
Features Index [1, 3]</code></pre>
</div>
</div>
<p>In backward stepwise selection, we got the <strong>feature 2 and 4</strong> as the best selection.</p>
</section>
<section id="c.-forward-stagewise" class="level5">
<h5 class="anchored" data-anchor-id="c.-forward-stagewise">c.&nbsp;Forward Stagewise</h5>
<p>From Forward Stepwise we know that the first feature is feature 5, now we need to find 2nd feature using stagewise increment</p>
<div class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x_5 <span class="op">=</span> x[:,<span class="dv">4</span>].copy()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>weight_5 <span class="op">=</span> <span class="fl">0.9160504114154776</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"feature, RSS Value, Weight"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">7</span>):</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> x[:,i].copy()</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> temp_x.T</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    xTx <span class="op">=</span> np.matmul(temp_x.T, temp_x)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    xTx_inv <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>xTx</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    weight <span class="op">=</span> xTx_inv<span class="op">*</span>np.matmul(temp_x.T,y)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> np.array([x_5,temp_x]).T</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> np.array([weight_5, weight])</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> np.matmul(temp_x, weights)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, np.<span class="bu">sum</span>((y<span class="op">-</span>y_hat)<span class="op">**</span><span class="dv">2</span>), weight)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>feature, RSS Value, Weight
0 1.4321712093629684 0.5005626828719334
1 1.8985698176821504 0.5004526294944694
2 2.808137102726856 0.9066846986089646
3 2.998941025794095 0.885160347571954
5 2.7347983916718257 0.7849334492064217
6 2.469091091780378 0.8177314873618696</code></pre>
</div>
</div>
<p>As we can see the RSS is least for <strong>feature 1</strong>.</p>
<p>Hence the two features which get selected are <strong>Festure 1 and 5</strong></p>
</section>
<section id="d.-bestsubset-selection" class="level5">
<h5 class="anchored" data-anchor-id="d.-bestsubset-selection">d.&nbsp;Bestsubset Selection</h5>
<div class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>comb <span class="op">=</span> <span class="bu">list</span>(itertools.combinations(features, <span class="dv">2</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> []</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> comb:</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> x.copy()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> temp_x.T</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    temp_x <span class="op">=</span> temp_x[<span class="bu">list</span>(c)].T</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    rss.append(get_rss(temp_x))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>rss <span class="op">=</span> np.array(rss)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>comb[rss.argmin()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre><code>(0, 3)</code></pre>
</div>
</div>
<p><strong>Features 1 and 4</strong> are the features having the least RSS value in all possible <span class="math inline">\(7\choose2\)</span> combinations for features</p>
</section>
</section>
<section id="explain-all-your-observations-based-on-the-results." class="level4">
<h4 class="anchored" data-anchor-id="explain-all-your-observations-based-on-the-results.">5. Explain all your observations based on the results.</h4>
<p>We see that the co-effectients for Linear Regression and Ridge Regression, doesn’t change much and all the features are being used as the co-effecients for all the seven features are non-zero values.</p>
<p>But when we use Lasso regression, we can see that features <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span> are dominant, and there is little influence of feature <span class="math inline">\(x_3\)</span>, but features 4,5,6 and 7 are having co-effecients 0. Here this is a feature selection and shrinkage methond, where we only need three features to predict the results</p>
<p>Similarly when we performed subset selection different methods yielded different features,</p>
<p>Forward Stepwise selection, is you select the first feature with least RSS which gives feature 5, and than pair with all other features. We find the new <span class="math inline">\(\beta's\)</span> for each pair and see which gives least RSS. We found that <strong>Feature 3 and 5</strong> is selected.</p>
<p>In Backward Stepwise selection, we start with all features, and kept on removing feature which harmed the RSS. We got <strong>features 2 and 4</strong></p>
<p>While, in Forward Stagewise, we don’t re train the <span class="math inline">\(\beta\)</span> after getting the <span class="math inline">\(\beta\)</span> for first selection of feature 5. We got <strong>feature 5 and 1</strong>. We also see that Forward Stepwise selection have features selection which gives lower RSS compared which showed that Forward Stepwise is better than Forward Stagewise, but the stagewise selection is computationally better than stepwise, since we don’t train the first selected parameter.</p>
<p>Finally, In subset selection we formed all combinations of features, where we had <span class="math inline">\(7\choose2\)</span> combinations and calculated RSS for each of the pair and selected the combination with the least RSS. This is computational heavy but gives the best two features. <strong>Features 1 amd 4</strong> are selected to best features. This selection method is least computationally effective solution, as it has to find parameters for all combinations.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>